"use strict";(self.webpackChunk_viotemplate_docs=self.webpackChunk_viotemplate_docs||[]).push([[686],{3905:function(e,t,l){l.d(t,{Zo:function(){return h},kt:function(){return p}});var r=l(7294);function a(e,t,l){return t in e?Object.defineProperty(e,t,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[t]=l,e}function i(e,t){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),l.push.apply(l,r)}return l}function n(e){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?i(Object(l),!0).forEach((function(t){a(e,t,l[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):i(Object(l)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(l,t))}))}return e}function o(e,t){if(null==e)return{};var l,r,a=function(e,t){if(null==e)return{};var l,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)l=i[r],t.indexOf(l)>=0||(a[l]=e[l]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)l=i[r],t.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(a[l]=e[l])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),l=t;return e&&(l="function"==typeof e?e(t):n(n({},t),e)),l},h=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var l=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,h=o(e,["components","mdxType","originalType","parentName"]),c=u(l),p=a,y=c["".concat(s,".").concat(p)]||c[p]||d[p]||i;return l?r.createElement(y,n(n({ref:t},h),{},{components:l})):r.createElement(y,n({ref:t},h))}));function p(e,t){var l=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=l.length,n=new Array(i);n[0]=c;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,n[1]=o;for(var u=2;u<i;u++)n[u]=l[u];return r.createElement.apply(null,n)}return r.createElement.apply(null,l)}c.displayName="MDXCreateElement"},7321:function(e,t,l){l.r(t),l.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return u},toc:function(){return h},default:function(){return c}});var r=l(7462),a=l(3366),i=(l(7294),l(3905)),n=["components"],o={sidebar_position:2},s="Architecture",u={unversionedId:"Packages/server/architecture",id:"Packages/server/architecture",title:"Architecture",description:"Overview",source:"@site/docs/Packages/server/architecture.mdx",sourceDirName:"Packages/server",slug:"/Packages/server/architecture",permalink:"/docs/Packages/server/architecture",editUrl:"https://github.com/otaviotech/ts-monorepo/tree/main/packages/docs/docs/Packages/server/architecture.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Tools",permalink:"/docs/Packages/server/tools"}},h=[{value:"Overview",id:"overview",children:[{value:"Is it overkill?",id:"is-it-overkill",children:[],level:3},{value:"Why is it an overkill?",id:"why-is-it-an-overkill",children:[],level:3},{value:"Why is it NOT an overkill?",id:"why-is-it-not-an-overkill",children:[],level:3}],level:2},{value:"Motivation",id:"motivation",children:[{value:"TypeScript",id:"typescript",children:[{value:"Is it necessary?",id:"is-it-necessary",children:[],level:4}],level:3}],level:2},{value:"Folder Structure",id:"folder-structure",children:[],level:2},{value:"Layers",id:"layers",children:[{value:"Presentation layer",id:"presentation-layer",children:[{value:"What this layer should do?",id:"what-this-layer-should-do",children:[],level:4},{value:"Patterns you&#39;ll find here:",id:"patterns-youll-find-here",children:[],level:4}],level:3},{value:"Domain layer",id:"domain-layer",children:[{value:"What this layer should do?",id:"what-this-layer-should-do-1",children:[],level:4},{value:"Patterns you wil find here",id:"patterns-you-wil-find-here",children:[],level:4}],level:3},{value:"Data layer",id:"data-layer",children:[{value:"What this layer should do?",id:"what-this-layer-should-do-2",children:[],level:4},{value:"Patterns you will find here",id:"patterns-you-will-find-here",children:[],level:4}],level:3},{value:"Infra layer",id:"infra-layer",children:[{value:"What this layer should do?",id:"what-this-layer-should-do-3",children:[],level:4},{value:"Patterns you will find here",id:"patterns-you-will-find-here-1",children:[],level:4}],level:3},{value:"Main layer",id:"main-layer",children:[{value:"What this layer should do?",id:"what-this-layer-should-do-4",children:[],level:4},{value:"Patterns you will find here",id:"patterns-you-will-find-here-2",children:[],level:4}],level:3}],level:2}],d={toc:h};function c(e){var t=e.components,o=(0,a.Z)(e,n);return(0,i.kt)("wrapper",(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"architecture"},"Architecture"),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"It's heavily inspired by Uncle Bob's ",(0,i.kt)("inlineCode",{parentName:"p"},"Clean Architeture"),"."),(0,i.kt)("p",null,"So, if you haven't read the book yet, here's a recommendation."),(0,i.kt)("h3",{id:"is-it-overkill"},"Is it overkill?"),(0,i.kt)("p",null,'The answer is: "it dependends".'),(0,i.kt)("p",null,"Maybe if you're building a simple app, which won't grow, or be coded by a large team, this is definetely an overkill."),(0,i.kt)("p",null,"But in the other hand, if you want to quickly bootstrap a project, with the right tools and a solid workflow, ready for scaling, you should consider this."),(0,i.kt)("h3",{id:"why-is-it-an-overkill"},"Why is it an overkill?"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Because your project will have a short lifecycle."),(0,i.kt)("li",{parentName:"ol"},"Because you won't mantain your codebase for much longer."),(0,i.kt)("li",{parentName:"ol"},"You don't care.")),(0,i.kt)("h3",{id:"why-is-it-not-an-overkill"},"Why is it NOT an overkill?"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"You get everything setup by the click of a button."),(0,i.kt)("li",{parentName:"ol"},"You have a battle-tested/optionated/solid architecture inspired project."),(0,i.kt)("li",{parentName:"ol"},"You have a large team and you don't have time to make code reviews to check for syntax errors."),(0,i.kt)("li",{parentName:"ol"},"You want to build a long term / forever evolving project that doesn't depend on implementations, so you can easily change libraries as time goes by. (Without having to re-write much code)")),(0,i.kt)("h2",{id:"motivation"},"Motivation"),(0,i.kt)("p",null,"Let's see why chose to use some tools."),(0,i.kt)("h3",{id:"typescript"},"TypeScript"),(0,i.kt)("h4",{id:"is-it-necessary"},"Is it necessary?"),(0,i.kt)("p",null,"No. definetely not. But it has some pros that we should take in count."),(0,i.kt)("p",null,"Let's suppose you have a large codebase."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"How easy is it to identify and use some business API?"),(0,i.kt)("li",{parentName:"ul"},"How easy is it to detect syntax errors?"),(0,i.kt)("li",{parentName:"ul"},"How easy is it to know what is an abstraction and what is an implementation?")),(0,i.kt)("p",null,"Static typechecking is very helpful when you don't overuse it."),(0,i.kt)("p",null,(0,i.kt)("em",{parentName:"p"},"Tip"),": Don't forget to read our ",(0,i.kt)("inlineCode",{parentName:"p"},"style guide"),", to understand how you should write TypeScript code in this project."),(0,i.kt)("h2",{id:"folder-structure"},"Folder Structure"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Folder Structure",src:l(4253).Z})),(0,i.kt)("h2",{id:"layers"},"Layers"),(0,i.kt)("p",null,"This is a quick explanation of what each layer should care about."),(0,i.kt)("h3",{id:"presentation-layer"},"Presentation layer"),(0,i.kt)("p",null,"This is where we handle and deliver data."),(0,i.kt)("h4",{id:"what-this-layer-should-do"},"What this layer should do?"),(0,i.kt)("p",null,"Currently, it should:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Validate (schema validate) an incoming request"),(0,i.kt)("li",{parentName:"ul"},"Route the request to the right UseCase (business logic handler)"),(0,i.kt)("li",{parentName:"ul"},"Handle Domain, Validation and Runtime errors and build an HTTP request. (E.g.: define what status code it should have)")),(0,i.kt)("h4",{id:"patterns-youll-find-here"},"Patterns you'll find here:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Controller"),(0,i.kt)("li",{parentName:"ul"},"Factory")),(0,i.kt)("h3",{id:"domain-layer"},"Domain layer"),(0,i.kt)("p",null,"This is where all of our business contracts live."),(0,i.kt)("p",null,"It should have only contracts(abstractions), not implementations."),(0,i.kt)("p",null,"Here you'll find UseCases, Errors, Events."),(0,i.kt)("h4",{id:"what-this-layer-should-do-1"},"What this layer should do?"),(0,i.kt)("p",null,"This layer should scream, by itself, all the software do.\nIt should not implement any business logic, but instead, show exactly how the API should be."),(0,i.kt)("h4",{id:"patterns-you-wil-find-here"},"Patterns you wil find here"),(0,i.kt)("p",null,"None, this should NOT implement anything."),(0,i.kt)("h3",{id:"data-layer"},"Data layer"),(0,i.kt)("p",null,"This is the layer that implements our business logic. Yes, the ones defined by the Domain layer."),(0,i.kt)("h4",{id:"what-this-layer-should-do-2"},"What this layer should do?"),(0,i.kt)("p",null,"This layer should implement the UseCases, for example."),(0,i.kt)("p",null,"Also, it should define its own contracts. These contracts are not Business contracts, like the ones in the Domain layer. Instead, these are contracts the define how the data logic can be implemented."),(0,i.kt)("p",null,"You can think of it like the Service layer of the 3 Layer Architecture. (but be careful)"),(0,i.kt)("h4",{id:"patterns-you-will-find-here"},"Patterns you will find here"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Factory"),(0,i.kt)("li",{parentName:"ul"},"Decorator")),(0,i.kt)("h3",{id:"infra-layer"},"Infra layer"),(0,i.kt)("p",null,"This is a layer where the data contracts are implemented.\nThings like ORM's and Email services implementations live here."),(0,i.kt)("h4",{id:"what-this-layer-should-do-3"},"What this layer should do?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Implement contracts defined by the Data layer"),(0,i.kt)("li",{parentName:"ul"},"Integrate with externa services like Database, Email, Logging, Push.")),(0,i.kt)("h4",{id:"patterns-you-will-find-here-1"},"Patterns you will find here"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Data Mapper"),(0,i.kt)("li",{parentName:"ul"},"Repository")),(0,i.kt)("h3",{id:"main-layer"},"Main layer"),(0,i.kt)("p",null,"This is the dirtiest layer of our whole software."),(0,i.kt)("p",null,"It's the only layer that know every implementation of every contract from every layer."),(0,i.kt)("p",null,"This is our Composition Root."),(0,i.kt)("p",null,"This can make magical things like swapping what service is being used to send emails or change the database implementation."),(0,i.kt)("h4",{id:"what-this-layer-should-do-4"},"What this layer should do?"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Define what implementation to use for each contract"),(0,i.kt)("li",{parentName:"ul"},"Compose every component of our software"),(0,i.kt)("li",{parentName:"ul"},"Instantiate every class needed"),(0,i.kt)("li",{parentName:"ul"},"Take care of all the components lifecycles")),(0,i.kt)("h4",{id:"patterns-you-will-find-here-2"},"Patterns you will find here"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Factory"),(0,i.kt)("li",{parentName:"ul"},"Composition Root"),(0,i.kt)("li",{parentName:"ul"},"Dependency Injection"),(0,i.kt)("li",{parentName:"ul"},"IoC Container")))}c.isMDXComponent=!0},4253:function(e,t,l){t.Z=l.p+"assets/images/folder_structure-a22591effdb40cef16a4e4e88268867e.png"}}]);